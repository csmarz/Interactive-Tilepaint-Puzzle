{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <script src={% static 'code.jquery.com_jquery-3.7.0.min.js' %}></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link rel="stylesheet" href={% static 'index.css' %}>
    <style>
        @layer utilities {
            body {
                background-size: 19rem;
                background-image: url('{% static "bg-3.png" %}');
            }
            input[type=number]::-webkit-inner-spin-button, 
            input[type=number]::-webkit-outer-spin-button { 
                -webkit-appearance: none; 
                margin: 0; 
            }
        }
    </style>

    <script>
        $(document).ready(() => {
            let editable = false;
            let isDragging = false;
            let coloring = false;
            let id = 1;
            let arr = [];
            let cells = [];
            let setColored = new Set();
            let coloredCell = 'bg-slate-400'
            let coloredButton = 'bg-green-800'
            let coloredHover = 'bg-green-900'
            let coloredActive = 'bg-green-700'
            let howToExtend = true;
            let challenge = false;
            let challengeNum = 1;
            let challangeData = [];

            const max = (a, b) => { if (a > b) return a; return b; }

            for (let i = 0; i < 250; i++) {
                $('#file').append(`<option value='${i+1}'>${i+1}</option>`);
            }

            const gen = () => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());
                if (m && n) {
                    setColored = new Set();
                    $('#solvestatus').empty();
                    $("#grid").empty();
                    id = 1;
                    arr = [];
                    cells = [];
                    $('#grid').removeClass('bg-green-400');
                    $('#grid').addClass('bg-orange-200');
                    for (let i = 0; i < 1e4; i++) {
                        arr.push(new Set());
                    }

                    for (let i = 0; i < m; i++) {
                        let tmp = [];
                        for (let j = 0; j < n; j++)
                            tmp.push(0);
                        cells.push(tmp);
                    }

                    for (let i = 0; i <= m; i++) {
                        $("#grid").append(`<div id=r${i} class='flex bg-white'>`);
                        if (i != 0) $(`#r${i}`).append(`<input id="CR${i}" type='number' min='0' class="constraint-row text-center w-10 h-10 border-2 border-red-500"></input>`);
                        for (let j = 0; j < n; j++) {
                            if (i == 0)
                                $(`#r${i}`).append(`<input id="CC${j+1}" type='number' min='0' class="constraint-col text-center w-10 h-10 border-2 border-red-500"></input>`);
                            else
                                if (j == 0 && i == 1) 
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-t-blue-500 border-l-blue-500 border-gray-300"></button>`);
                                else if (i == 1 && j == n - 1)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-r-blue-500 border-t-blue-500 border-gray-300"></button>`);
                                else if (i == 1)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-t-blue-500 border-gray-300"></button>`);
                                else if (i == m && j == 0)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-b-blue-500 border-l-blue-500 border-gray-300"></button>`);
                                else if (i == m && j == n - 1)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-b-blue-500 border-r-blue-500 border-gray-300"></button>`);
                                else if (j == 0)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-l-blue-500 border-gray-300"></button>`);
                                else if (j == n - 1)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-r-blue-500 border-gray-300"></button>`);
                                else if (i == m)
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-b-blue-500 border-gray-300"></button>`);
                                else
                                    $(`#r${i}`).append(`<button id="${(i-1)*$('#N').val()+j+1}" class="cell text-center w-10 h-10 border-2 border-gray-300"></button>`);
                        }
                    }
                }
            }
            
            gen();

            $('#gen').click(() => {
                if (!coloring) {
                    gen();
                }
            });

            $('#edit').click(() => {
                if (!coloring && !challenge) {
                    
                    setColored = new Set();
                    let m = Number($('#M').val()), n = Number($('#N').val());
                    for (let i = 1; i <= m*n; i++) {
                        $(`#${i}`).empty();
                        $(`#${i}`).removeClass(coloredCell);
                    }
                    editable = !editable
                    if (editable) {
                        $('#tutorial-msg').empty();
                        $('#tutorial-msg').append('Click a cell')
                        $('#determine').removeClass('bg-yellow-600')
                        $('#determine').addClass('bg-gray-500')
                        $('#determine').removeClass('hover:bg-yellow-500')
                        $('#determine').removeClass('active:bg-yellow-700')
                        $('#color').prop('disable', true);
                        $('#color').removeClass('bg-cyan-600')
                        $('#color').removeClass('hover:bg-cyan-500')
                        $('#color').removeClass('active:bg-cyan-700')
                        $('#color').addClass('bg-gray-600')
                        $('#edit').removeClass('bg-blue-600')
                        $('#edit').removeClass('hover:bg-blue-500')
                        $('#edit').removeClass('active:bg-blue-700')
                        $('#edit').addClass('bg-red-600')
                        $('#edit').addClass('hover:bg-red-500')
                        $('#edit').addClass('active:bg-red-700')
                    } else {
                        $('#tutorial-msg').empty()
                        $('#determine').removeClass('bg-gray-500')
                        $('#determine').addClass('bg-yellow-600')
                        $('#determine').addClass('hover:bg-yellow-500')
                        $('#determine').addClass('active:bg-yellow-700')
                        $('#edit').removeClass('bg-red-600')
                        $('#edit').removeClass('hover:bg-red-500')
                        $('#edit').removeClass('active:bg-red-700')
                        $('#edit').addClass('bg-blue-600')
                        $('#edit').addClass('hover:bg-blue-500')
                        $('#edit').addClass('active:bg-blue-700')
                        $('#color').prop('disable', false);
                        $('#color').removeClass('bg-gray-600')
                        $('#color').addClass('bg-cyan-600')
                        $('#color').addClass('hover:bg-cyan-500')
                        $('#color').addClass('active:bg-cyan-700')
                    }
                }
            });

            const idToCell = (id) => {
                id--;
                let n = Number($('#N').val());
                return [Math.floor(id/n), id%n];
            }

            const cellToId = (x, y) => {
                let n = Number($('#N').val());
                return (x*n + y) + 1;
            }

            const isInside = (x, y) => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());
                return x >= 0 && y >= 0 && x < m && y < n;
            }

            let g = [], visited = [], s = {}, last = 1;

            const validate = () => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());

                let CC = [];
                for (let i = 1; i <= n; i++) {
                    if (!$(`#CC${i}`).val()) 
                        CC.push(-1);
                    else 
                        CC.push(Number($(`#CC${i}`).val()));
                }
                let CR = [];
                for (let i = 1; i <= m; i++) {
                    if (!$(`#CR${i}`).val()) 
                        CR.push(-1);
                    else
                        CR.push(Number($(`#CR${i}`).val()));
                }

                let data = {
                    m: Number($('#M').val()),
                    n: Number($('#N').val()),
                    S: Array.from(setColored),
                    CG: visited,
                    CC,
                    CR,
                };

                // console.log(data);
                $.post('/api/validate', JSON.stringify(data), (res, status) => {
                    // console.log(res);
                    if (res.Model == true) {
                        if (challenge) {
                            challangeData[challengeNum-1].solved = true;
                            $(`#CL${challengeNum}`).removeClass('bg-gray-400');
                            $(`#CL${challengeNum}`).addClass('bg-green-400');
                        }
                        $('#tutorial-msg').empty()
                        $('#tutorial-msg').append('Solved')
                        $('#grid').removeClass('bg-orange-200');
                        $('#grid').addClass('bg-green-400');
                    } else {
                        if (challenge) {
                            challangeData[challengeNum-1].solved = false;
                            $(`#CL${challengeNum}`).addClass('bg-gray-400');
                            $(`#CL${challengeNum}`).removeClass('bg-green-400');
                        }
                        $('#grid').removeClass('bg-green-400');
                        $('#grid').addClass('bg-orange-200');
                        if (!challenge) {
                            $('#tutorial-msg').empty()
                        }
                    }
                });
            }

            $('#manual-validate').click(() => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());

                let CC = [];
                for (let i = 1; i <= n; i++) {
                    if (!$(`#CC${i}`).val()) 
                        CC.push(-1);
                    else 
                        CC.push(Number($(`#CC${i}`).val()));
                }
                let CR = [];
                for (let i = 1; i <= m; i++) {
                    if (!$(`#CR${i}`).val()) 
                        CR.push(-1);
                    else
                        CR.push(Number($(`#CR${i}`).val()));
                }

                let data = {
                    m: Number($('#M').val()),
                    n: Number($('#N').val()),
                    S: Array.from(setColored),
                    CG: visited,
                    CC,
                    CR,
                };

                // console.log(data);
                $.post('/api/validate', JSON.stringify(data), (res, status) => {
                    // console.log(res);
                    if (res?.Model == true) {
                        if (challenge) {
                            challangeData[challengeNum-1].solved = true;
                            $(`#CL${challengeNum}`).removeClass('bg-gray-300');
                            $(`#CL${challengeNum}`).addClass('bg-green-300');
                        }
                        $('#tutorial-msg').empty()
                        $('#tutorial-msg').append('Solved!');
                        $('#grid').removeClass('bg-orange-200');
                        $('#grid').addClass('bg-green-400');
                    } else {
                        if (challenge) {
                            challangeData[challengeNum-1].solved = false;
                            $(`#CL${challengeNum}`).addClass('bg-gray-300');
                            $(`#CL${challengeNum}`).removeClass('bg-green-300');
                        }
                        for (let i = 1; i <= m; i++) 
                            if (res?.cr.includes(i)) 
                                $(`#CR${i}`).addClass('bg-red-300');
                        for (let i = 1; i <= n; i++) 
                            if (res?.cc.includes(i)) 
                                $(`#CC${i}`).addClass('bg-red-300');

                        $('#grid').removeClass('bg-green-400');
                        $('#grid').addClass('bg-orange-200');
                        $('#tutorial-msg').empty()
                        $('#tutorial-msg').append('You are on the wrong track. Keep trying!');
                    }
                });
            });

            const detemineTile = () => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());

                g = [], visited = [], s = {}, last = 1;

                for (let i = 0; i < m; i++) {
                    let tmp = [], vis = [];
                    for (let j = 0; j < n; j++) {
                        vis.push(0);
                        if (cells[i][j] == 0) {
                            tmp.push(0);
                        } else if (cells[i][j] in s) {
                            tmp.push(s[cells[i][j]]);
                        } else {
                            tmp.push(last);
                            s[cells[i][j]] = last;
                            last++;
                        }
                    }
                    g.push(tmp);
                    visited.push(vis);
                }

                let moveX = [0, 0, 1, -1];
                let moveY = [1, -1, 0, 0];

                const dfs = (x, y, cur) => {
                    visited[x][y] = cur;
                    for (let i = 0; i < 4; i++) {
                        let new_x = x + moveX[i], new_y = y + moveY[i];
                        if (isInside(new_x, new_y) && g[new_x][new_y] === g[x][y] && !visited[new_x][new_y]) {
                            dfs(new_x, new_y, cur)
                        }
                    }
                }

                let cur = 1;
                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        if (!visited[i][j]) {
                            dfs(i, j, cur);
                            cur++;
                        }
                    }
                }
            
                // for (let i = 1; i <= m*n; i++) {
                //     $(`#${i}`).empty();
                //     $(`#${i}`).append(`<p id='${i}' class='text-red-400 font-semibold'>${visited[idToCell(i)[0]][idToCell(i)[1]]}</p>`);
                // }

                $('#solvestatus').empty();
            }

            const constructGrid = (m, n, res, S, complete, solved = false, cc = null, cr = null) => {
                $('#M').val(m);
                $('#N').val(n);

                gen();
                
                let CC = [], CR = []
                for (let i = 0; i < m; i++)
                    CR.push(0);
                for (let i = 0; i < n; i++)
                    CC.push(0);

                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        cells[i][j] = Number(res[i][j]);
                        id = max(id, Number(res[i][j]));
                        if (S.has(res[i][j])) {
                            CR[i]++, CC[j]++;
                        }
                    }
                }

                for (let i = 0; i < n; i++) {
                    if (!cc) {
                        if (Math.floor(Math.random() * 10) >= 3 || complete < 1)
                            $(`#CC${i+1}`).val(CC[i]);
                    } else {
                        if (cc.includes(i) || complete < 1) 
                            $(`#CC${i+1}`).val(CC[i]);
                    }
                }
                for (let i = 0; i < m; i++) {
                    if (!cr) {
                        if (Math.floor(Math.random() * 10) >= 3 || complete < 1)
                            $(`#CR${i+1}`).val(CR[i]);
                    } else {
                        if (cr.includes(i) || complete < 1) 
                            $(`#CR${i+1}`).val(CR[i]);
                    }
                }

                detemineTile();

                if (solved) {
                    for (let i = 0; i < m; i++) {
                        for (let j = 0; j < n; j++) {
                            if (S.has(cells[i][j])) {
                                $(`#${(i)*$('#N').val()+j+1}`).addClass(coloredCell);
                            }
                        }
                    }
                    $('#solvestatus').empty()
                    $('#solvestatus').append('Solved')
                    $('#grid').removeClass('bg-orange-200');
                    $('#grid').addClass('bg-green-400');
                } else {
                    $('#grid').removeClass('bg-green-400');
                    $('#grid').addClass('bg-orange-200');
                    $('#solvestatus').empty()
                }

                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        if (isInside(i+1, j) && cells[i+1][j] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-b-blue-700');
                        if (isInside(i, j+1) && cells[i][j+1] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-r-blue-700');
                        if (isInside(i-1, j) && cells[i-1][j] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-t-blue-700');
                        if (isInside(i, j-1) && cells[i][j-1] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-l-blue-700');
                    }
                }
            }

            const constructRandomGrid = (level = 0) => {
                let m = Math.floor(Math.random() * 15) + 1, n = Math.floor(Math.random() * 15) + 1;

                if (level != 0) {
                    if (level <= 5) {
                        m = 4;
                        n = 4;
                    } else if (level <= 11) {
                        m = 5;
                        n = 5;
                    } else if (level <= 17) {
                        m = 7;
                        n = 7;
                    } else {
                        m = 10;
                        n = 10;
                    }
                }

                let totalCell = m * n;
                let moveX = [0, 0, 1, -1];
                let moveY = [1, -1, 0, 0];

                let res = [];
                for (let i = 0; i < m; i++) {
                    let tmp = [];
                    for (let j = 0; j < n; j++)
                        tmp.push(0);
                    res.push(tmp);
                }

                const isInside2 = (x, y) => {
                    return x >= 0 && y >= 0 && x < m && y < n;
                }

                let c = 0;
                const dfs = (n, x, y, cur) => {
                    if (c < n) {
                        res[x][y] = cur;

                        for (let i = 0; i < 4; i++) {
                            let rand = Math.floor(Math.random() * 4);
                            let new_x = x + moveX[rand], new_y = y + moveY[rand];
                            if (isInside2(new_x, new_y) && !res[new_x][new_y]) {
                                c += 1
                                dfs(n, new_x, new_y, cur);
                            }
                        }
                    }
                }

                let cellNum = 1;
                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        if (res[i][j] == 0) {
                            let tmp = 0;

                            tmp = Math.floor(Math.random() * 5) + 1;
                            if (level != 0) {
                                if (level <= 3) {
                                    tmp = Math.floor(Math.random() * 3) + 1;
                                } else if (level <= 7) {
                                    tmp = Math.floor(Math.random() * 10) + 1;
                                } else if (level <= 12) {
                                    tmp = Math.floor(Math.random() * 8) + 2;
                                } else if (level <= 17) {
                                    tmp = Math.floor(Math.random() * 6) + 3;
                                } else {
                                    tmp = Math.floor(Math.random() * 5) + 1;
                                }
                            }
                            c = 0;

                            dfs(tmp, i, j, cellNum++);
                        }
                    }
                }
                // console.log(res);
                
                let numberColor = Math.floor(Math.random() * Math.floor(cellNum*2 / 3)) + Math.floor(cellNum / 6);
                let i = 0;
                let S = new Set();
                do {
                    let tmp = Math.floor(Math.random() * cellNum-1) + 1;
                    if (!S.has(tmp)) {
                        S.add(tmp);
                        i++
                    }
                } while (i < numberColor);

                let complete = Math.floor(Math.random() * 3);
                if (level != 0) {
                    if (level <= 3) {
                        complete = 2;
                    } else if (level <= 5) {
                        complete = 0;
                    } else if (level <= 8) {
                        complete = 2;
                    } else if (level <= 11) {
                        complete = 0;
                    } else if (level <= 14) {
                        complete = 2;
                    } else if (level <= 17) {
                        complete = 0;
                    } else if (level <= 19) {
                        complete = 2;
                    } else {
                        complete = 0;
                    }
                }

                let cc = [], cr = [];
                let num_cc = Math.floor(Math.random() * m) + 1, num_cr = Math.floor(Math.random() * n) + 1;
                for (let i = 0; i < num_cc; i++) {
                    let rand = 0;
                    do {
                        rand = Math.floor(Math.random() * m);
                    } while (cc.includes(rand));
                    cc.push(rand);
                }
                for (let i = 0; i < num_cr; i++) {
                    let rand = 0;
                    do {
                        rand = Math.floor(Math.random() * n);
                    } while (cr.includes(rand));
                    cr.push(rand);
                }

                cr.sort(), cc.sort();

                if (level == 0) {
                    constructGrid(m, n, res, S, complete);
                } else {
                    challangeData.push({
                        m,
                        n,
                        S,
                        res,
                        complete,
                        solved: false,
                        cc,
                        cr
                    });
                }
            }

            $('.challenge-num').click((e) => {
                // console.log(challangeData);
                try {
                    constructGrid(challangeData[e.target.value-1].m, challangeData[e.target.value-1].n, challangeData[e.target.value-1].res, challangeData[e.target.value-1].S, challangeData[e.target.value-1].complete, challangeData[e.target.value-1].solved, challangeData[e.target.value-1].cc, challangeData[e.target.value-1].cr)
                    
                    $(`#CL${challengeNum}`).removeClass('text-cyan-300');
                    $(`#CL${challengeNum}`).removeClass('border-cyan-500');
                    challengeNum = e.target.value;
                    $(`#CL${challengeNum}`).addClass('text-cyan-300');
                    $(`#CL${challengeNum}`).addClass('border-cyan-500');
                    if (challenge) {
                        $('#tutorial-msg').empty();
                        if (challangeData[challengeNum-1].solved) 
                            $('#tutorial-msg').append('Solved!');
                        else
                            $('#tutorial-msg').append('Click a cell to color or uncolor');
                    }
                } catch (e) {

                }
            });

            const disableAll = () => {
                if (challenge) {
                    $('#color').removeClass('bg-cyan-600')
                    $('#color').removeClass('hover:bg-cyan-500')
                    $('#color').removeClass('active:bg-cyan-700')
                    $('#color').addClass('bg-gray-500')
                    $('#random').removeClass('bg-orange-600')
                    $('#random').removeClass('hover:bg-orange-500')
                    $('#random').removeClass('active:bg-orange-700')
                    $('#random').addClass('bg-gray-500')
                    $('#solve').removeClass('bg-purple-600')
                    $('#solve').removeClass('hover:bg-purple-500')
                    $('#solve').removeClass('active:bg-purple-700')
                    $('#solve').addClass('bg-gray-500')
                    $('#edit').prop('disable', true);
                    $('#edit').removeClass('bg-blue-600')
                    $('#edit').removeClass('hover:bg-blue-500')
                    $('#edit').removeClass('active:bg-blue-700')
                    $('#edit').addClass('bg-gray-500')
                    $('#gen').removeClass('bg-green-600')
                    $('#gen').removeClass('hover:bg-green-500')
                    $('#gen').removeClass('active:bg-green-700')
                    $('#gen').addClass('bg-gray-500')
                } else {
                    $('#color').removeClass('bg-gray-500')
                    $('#color').addClass('bg-cyan-600')
                    $('#color').addClass('hover:bg-cyan-500')
                    $('#color').addClass('active:bg-cyan-700')
                    $('#random').removeClass('bg-gray-500')
                    $('#random').addClass('bg-orange-600')
                    $('#random').addClass('hover:bg-orange-500')
                    $('#random').addClass('active:bg-orange-700')
                    $('#solve').addClass('bg-purple-600')
                    $('#solve').addClass('hover:bg-purple-500')
                    $('#solve').addClass('active:bg-purple-700')
                    $('#solve').removeClass('bg-gray-500')
                    $('#edit').prop('disable', false);
                    $('#edit').removeClass('bg-gray-500')
                    $('#edit').addClass('bg-blue-600')
                    $('#edit').addClass('hover:bg-blue-500')
                    $('#edit').addClass('active:bg-blue-700')
                    $('#gen').removeClass('bg-gray-500')
                    $('#gen').addClass('bg-green-600')
                    $('#gen').addClass('hover:bg-green-500')
                    $('#gen').addClass('active:bg-green-700')
                }
            }

            $('#challenge').click(() => {
                challenge = !challenge;
                disableAll();
                if (challenge) {
                    $(`#CL${challengeNum}`).removeClass('border-cyan-500');
                    $(`#CL${challengeNum}`).removeClass('text-cyan-300');
                    for (let i = 1; i <= 20; i++) {
                        $(`#CL${i}`).removeClass('bg-gray-500');
                        $(`#CL${i}`).addClass('bg-gray-400');
                        $(`#CL${i}`).addClass('hover:bg-gray-300');
                        $(`#CL${i}`).addClass('active:bg-gray-500');
                    }

                    $(`#CL1`).addClass('border-cyan-500');
                    $(`#CL1`).addClass('text-cyan-300');

                    $('#tutorial-msg').append('Click a cell to color or uncolor');
                    challangeData = [];
                    for (let i = 1; i <= 20; i++) { $(`#CL${i}`).removeClass('bg-green-300'); $(`#CL${i}`).addClass('bg-gray-300'); }

                    challengeNum = 1;
                    for (let i = 1; i <= 20; i++) {
                        constructRandomGrid(i);
                    }
                    // console.log(challangeData);
                    $('#challenge').empty();
                    $('#challenge').removeClass('bg-green-600');
                    $('#challenge').removeClass('hover:bg-green-500');
                    $('#challenge').removeClass('active:bg-green-700');
                    $('#challenge').addClass('bg-red-600');
                    $('#challenge').addClass('hover:bg-red-500');
                    $('#challenge').addClass('active:bg-red-700');
                    $('#challenge').append('Give Up');
                    constructGrid(challangeData[0].m, challangeData[0].n, challangeData[0].res, challangeData[0].S, challangeData[0].complete, challangeData[0].solved, challangeData[0].cc, challangeData[0].cr)
                    coloring = 1;
                } else {
                    let m = $('#M').val();
                    let n = $('#N').val();
                    for (let i = 1; i <= n; i++)
                        $(`#CC${i}`).removeClass('bg-red-300'); 
                    for (let i = 1; i <= m; i++)
                        $(`#CR${i}`).removeClass('bg-red-300'); 
                    
                    $('#tutorial-msg').empty();
                    coloring = 0;
                    $('#challenge').empty();
                    $('#challenge').addClass('bg-green-600');
                    $('#challenge').addClass('hover:bg-green-500');
                    $('#challenge').addClass('active:bg-green-700');
                    $('#challenge').removeClass('bg-red-600');
                    $('#challenge').removeClass('hover:bg-red-500');
                    $('#challenge').removeClass('active:bg-red-700');
                    $('#challenge').append('Challenge!');
                }
            });

            $('#howtobutton').click(() => {
                howToExtend = !howToExtend;
                if (!howToExtend) {
                    $('#howtobutton').empty();
                    $('#howtobutton').append('+');
                } else {
                    $('#howtobutton').empty();
                    $('#howtobutton').append('-');
                }
                $(".howto").slideToggle();
            })

            $('#random').click(() => {
                if (!challenge)
                    constructRandomGrid();
            });

            $('#file').on('change', async (e) => {
                let res = e.target.value;

                if (res == '-') return;

                let arr;
                await $.get(`/api/getTC/${res}`, (res, status) => {
                    arr = res['res']
                })

                let a;
                let m = arr[0][0], n = arr[0][1]

                $('#M').val(m);
                $('#N').val(n);

                gen();

                for (let i = 0; i < n; i++)
                    if (arr[1][i] != -1)
                        $(`#CC${i+1}`).val(arr[1][i]);
                for (let i = 0; i < m; i++)
                    if (arr[2][i] != -1)
                        $(`#CR${i+1}`).val(arr[2][i]);

                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        cells[i][j] = Number(arr[i+3][j]);
                        id = max(id, Number(arr[i+3][j]));
                    }
                }

                for (let i = 0; i < m; i++) {
                    for (let j = 0; j < n; j++) {
                        if (isInside(i+1, j) && cells[i+1][j] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-b-blue-700');
                        if (isInside(i, j+1) && cells[i][j+1] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-r-blue-700');
                        if (isInside(i-1, j) && cells[i-1][j] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-t-blue-700');
                        if (isInside(i, j-1) && cells[i][j-1] != cells[i][j]) 
                            $(`#${cellToId(i,j)}`).addClass('border-l-blue-700');
                    }
                }
            });

            $('#clear').click(() => {
                if (!coloring) {
                    let m = Number($('#M').val()), n = Number($('#N').val());
                    for (let i = 1; i <= m*n; i++) {
                        $(`#${i}`).empty();
                        $(`#${i}`).removeClass(coloredCell);
                    }
                    $('.constraint-col').val('');
                    $('.constraint-row').val('');
                    $('#status').empty();
                    $('#tutorial-msg').empty();
                    $('#grid').removeClass('bg-green-400');
                    $('#grid').addClass('bg-orange-200');
                    setColored = new Set();
                }
            });

            $('#color').click(() => {
                if (!editable && !challenge) {
                    coloring = !coloring;
    
                    detemineTile();
                    if (coloring) {
                        $('#tutorial-msg').empty();
                        $('#tutorial-msg').append('Click a cell to color or uncolor');
                        $('#determine').removeClass('bg-yellow-600')
                        $('#determine').addClass('bg-gray-500')
                        $('#determine').removeClass('hover:bg-yellow-500')
                        $('#determine').removeClass('active:bg-yellow-700')
                        $('#color').removeClass('bg-cyan-600')
                        $('#color').removeClass('hover:bg-cyan-500')
                        $('#color').removeClass('active:bg-cyan-700')
                        $('#color').addClass('bg-red-600')
                        $('#color').addClass('hover:bg-red-500')
                        $('#color').addClass('active:bg-red-700')
                        $('#edit').prop('disable', true);
                        $('#edit').removeClass('bg-blue-600')
                        $('#edit').removeClass('hover:bg-blue-500')
                        $('#edit').removeClass('active:bg-blue-700')
                        $('#edit').addClass('bg-gray-500')
                        $('#gen').removeClass('bg-green-600')
                        $('#gen').removeClass('hover:bg-green-500')
                        $('#gen').removeClass('active:bg-green-700')
                        $('#gen').addClass('bg-gray-500')
                        $('#clear').removeClass('bg-red-600')
                        $('#clear').removeClass('hover:bg-red-500')
                        $('#clear').removeClass('active:bg-red-700')
                        $('#clear').addClass('bg-gray-500')
                    } else {
                        $('#tutorial-msg').empty();
                        $('#determine').removeClass('bg-gray-500')
                        $('#determine').addClass('bg-yellow-600')
                        $('#determine').addClass('hover:bg-yellow-500')
                        $('#determine').addClass('active:bg-yellow-700')
                        $('#color').removeClass('bg-red-600')
                        $('#color').removeClass('hover:bg-red-500')
                        $('#color').removeClass('active:bg-red-700')
                        $('#color').addClass('bg-cyan-600')
                        $('#color').addClass('hover:bg-cyan-500')
                        $('#color').addClass('active:bg-cyan-700')
                        $('#edit').prop('disable', false);
                        $('#edit').removeClass('bg-gray-500')
                        $('#edit').addClass('bg-blue-600')
                        $('#edit').addClass('hover:bg-blue-500')
                        $('#edit').addClass('active:bg-blue-700')
                        $('#gen').removeClass('bg-gray-500')
                        $('#gen').addClass('bg-green-600')
                        $('#gen').addClass('hover:bg-green-500')
                        $('#gen').addClass('active:bg-green-700')
                        $('#clear').removeClass('bg-gray-500')
                        $('#clear').addClass('bg-red-600')
                        $('#clear').addClass('hover:bg-red-500')
                        $('#clear').addClass('active:bg-red-700')
                    }
                }
            });

            $('#determine').click(() => {
                if (editable) return;
                detemineTile();
            });

            $('#M').change((e) => {
                if (e.target.value > 20) 
                    $('#M').val(20);
                if (e.target.value < 1) 
                    $('#M').val(1);
            });

            $('#N').change((e) => {
                if (e.target.value > 20) 
                    $('#N').val(20);
                if (e.target.value < 1) 
                    $('#N').val(1);
            });

            $('#solve').click(() => {
                if (challenge) return;

                $('#solve').empty();
                $('#solve').append('<div class="flex items-center"> <svg aria-hidden="true" class="w-5 h-5 mr-2 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor"/> <path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentFill"/></svg> Solve!</div>');
                
                let m = Number($('#M').val()), n = Number($('#N').val());

                for (let i = 1; i <= m*n; i++) {
                    $(`#${i}`).empty();
                    $(`#${i}`).removeClass(coloredCell);
                }

                detemineTile();
                
                let CC = [];
                for (let i = 1; i <= n; i++) {
                    if (!$(`#CC${i}`).val()) 
                        CC.push(-1);
                    else 
                        CC.push(Number($(`#CC${i}`).val()));
                }
                let CR = [];
                for (let i = 1; i <= m; i++) {
                    if (!$(`#CR${i}`).val()) 
                        CR.push(-1);
                    else
                        CR.push(Number($(`#CR${i}`).val()));
                }

                let data = {
                    m: Number($('#M').val()),
                    n: Number($('#N').val()),
                    CC,
                    CR,
                    CG: visited ?? [[1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1], [1, 1, 1, 1]]
                };
                
                $("#tutorial-msg").empty();
                for (let i = 1; i <= m; i++) 
                    $(`#CR${i}`).removeClass('bg-red-300');
                for (let i = 1; i <= n; i++) 
                    $(`#CC${i}`).removeClass('bg-red-300');
                // console.log(data);
                $.post('/api/solver', JSON.stringify(data), (res, status) => {
                    $('#solve').empty();
                    $('#solve').append('Solve!');
                    // console.log(res);
                    let model = res?.Model
                    if (!model) {
                        $('#grid').removeClass('bg-green-400');
                        $('#grid').addClass('bg-orange-200');
                        $('#tutorial-msg').append('No Solution');
                        return;
                    }

                    for (let i = 0; i < model.length; i++) {
                        // console.log(model[i]);
                        if (model[i] > 0) {
                            setColored.add(visited[idToCell(model[i])[0]][idToCell(model[i])[1]]);
                            $(`#${Math.abs(model[i])}`).addClass(coloredCell);
                        } else
                            $(`#${Math.abs(model[i])}`).removeClass(coloredCell);
                    }
                    // console.log(setColored);
                    $("#tutorial-msg").append("Solved");
                    $('#grid').removeClass('bg-orange-200');
                    $('#grid').addClass('bg-green-400');
                });
            });

            let prev = '';

            $('#grid')
            .on('click', '.constraint-col', (e) => {
                if (challenge) prev = e.target.value;
                }
            )
            .on('click', '.constraint-row', (e) => {
                if (challenge) prev = e.target.value;
                }
            )
            .on('change', '.constraint-col', (e) => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());

                if (challenge) {
                    e.target.value = prev;
                    return;
                }

                if (e.target.value == '')
                    return;

                if (e.target.value >= m)
                    e.target.value = m;
                if (e.target.value <= 0)
                    e.target.value = 0;
                }
            )   
            .on('change', '.constraint-row', (e) => {
                let m = Number($('#M').val());
                let n = Number($('#N').val());
                
                if (challenge) {
                    e.target.value = prev;
                    return;
                }

                if (e.target.value == '')
                    return;

                if (e.target.value >= n)
                    e.target.value = n;
                if (e.target.value <= 0)
                    e.target.value = 0;
                }
            )
            .on('mousedown', '.cell', (e) => {
                isDragging = true;
                
                let m = Number($('#M').val());
                let n = Number($('#N').val());

                for (let i = 1; i <= m; i++) 
                    $(`#CR${i}`).removeClass('bg-red-300');
                for (let i = 1; i <= n; i++) 
                    $(`#CC${i}`).removeClass('bg-red-300');
                
                if (coloring) {
                    // console.log(e.target.id);
                    let now = Number(e.target.id);
                    for (let i = 1; i <= m; i++) 
                        for (let j = 1; j <= n; j++) 
                            if (visited[i-1][j-1] === visited[idToCell(now)[0]][idToCell(now)[1]])
                                if ($(`#${(i-1)*n+j}`).hasClass(coloredCell)) {
                                    $(`#${(i-1)*n+j}`).removeClass(coloredCell);
                                    if (setColored.has(visited[idToCell(now)[0]][idToCell(now)[1]]))
                                        setColored.delete(visited[idToCell(now)[0]][idToCell(now)[1]])
                                } else {
                                    $(`#${(i-1)*n+j}`).addClass(coloredCell);
                                    if (!setColored.has(visited[idToCell(now)[0]][idToCell(now)[1]])) 
                                        setColored.add(visited[idToCell(now)[0]][idToCell(now)[1]])
                                }
                    validate();
                }

                if (challenge) {
                    $('#tutorial-msg').empty();
                    $('#tutorial-msg').append('Click a cell to color or uncolor');
                }

                if (editable) {
                    $('#tutorial-msg').empty();
                    $('#tutorial-msg').append('Drag your cursor over adjacent cells to make them in the same tile');

                    let now = Number(e.target.id);
                    arr[id].add(now);

                    let x = idToCell(now)[0], y = idToCell(now)[1];

                    cells[x][y] = id;
                    document.getElementById(now).classList.add('border-r-blue-700');
                    document.getElementById(now).classList.add('border-l-blue-700');
                    document.getElementById(now).classList.add('border-t-blue-700');
                    document.getElementById(now).classList.add('border-b-blue-700');

                    if (isInside(x, y+1) && cells[x][y+1] != cells[x][y]) {
                        $(`#${cellToId(x,y+1)}`).addClass('border-l-blue-700');
                    }
                    if (isInside(x, y-1) && cells[x][y-1] != cells[x][y]) {
                        $(`#${cellToId(x,y-1)}`).addClass('border-r-blue-700');
                    }
                    if (isInside(x+1, y) && cells[x+1][y] != cells[x][y]) {
                        $(`#${cellToId(x+1,y)}`).addClass('border-t-blue-700');
                    }
                    if (isInside(x-1, y) && cells[x-1][y] != cells[x][y]) {
                        $(`#${cellToId(x-1,y)}`).addClass('border-b-blue-700');
                    }
                }
            })
            .on('mousemove', '.cell', (e) => {
                if (!isDragging) return;
                if (editable) {

                    let now = Number(e.target.id);
    
                    let m = Number($('#M').val());
                    let n = Number($('#N').val());
                    
                    document.getElementById(now).classList.add('border-r-blue-700');
                    document.getElementById(now).classList.add('border-l-blue-700');
                    document.getElementById(now).classList.add('border-t-blue-700');
                    document.getElementById(now).classList.add('border-b-blue-700');
    
                    arr[id].add(now);

                    let x = idToCell(now)[0], y = idToCell(now)[1];
                    
                    cells[x][y] = id;
                    if (arr[id].has(now+1)) {   // kanan
                        if (now % n != 0)
                            document.getElementById(now).classList.remove('border-r-blue-700');
    
                        if (((now+1) % n) != 1)
                            document.getElementById(now+1).classList.remove('border-l-blue-700');
                    }
                    if (arr[id].has(now-1)) {   // kiri
                        if ((now) % n != 1)
                            document.getElementById(now).classList.remove('border-l-blue-700');
                        
                        if (((now-1) % n) != 0)
                            document.getElementById(now-1).classList.remove('border-r-blue-700');
                    }
                    if (arr[id].has(now-n)) {   // atas
                        document.getElementById(now).classList.remove('border-t-blue-700');
                        document.getElementById(now-n).classList.remove('border-b-blue-700');
                    }
                    if (arr[id].has(now+n)) {   // bawah
                        document.getElementById(now).classList.remove('border-b-blue-700');
                        document.getElementById(now+n).classList.remove('border-t-blue-700');
                    }

                    if (isInside(x, y+1) && cells[x][y+1] != cells[x][y]) {
                        $(`#${cellToId(x,y+1)}`).addClass('border-l-blue-700');
                    }
                    if (isInside(x, y-1) && cells[x][y-1] != cells[x][y]) {
                        $(`#${cellToId(x,y-1)}`).addClass('border-r-blue-700');
                    }
                    if (isInside(x+1, y) && cells[x+1][y] != cells[x][y]) {
                        $(`#${cellToId(x+1,y)}`).addClass('border-t-blue-700');
                    }
                    if (isInside(x-1, y) && cells[x-1][y] != cells[x][y]) {
                        $(`#${cellToId(x-1,y)}`).addClass('border-b-blue-700');
                    }
                }
            })
            .on('mouseup', '.cell', () => {
                if (editable) { 
                    $('#tutorial-msg').empty();
                    $('#tutorial-msg').append('Click a cell');
                }             

                prev = 0;
                isDragging = false;
                id++;
            })
        })
    </script>
</head>
<body>
    <nav class="flex z-20 flex-col items-center py-4 px-32 bg-white border-b-2 border-green-500">
        <p class="text-5xl font-bold">Tilepaint Puzzle App</p>
    </nav>
    <div class="z-10 flex flex-col items-center gap-6 py-4">
        <div class="flex flex-col items-center">
            <p class="text-3xl font-semibold">Tilepaint</p>
            <hr class="bg-green-600 w-24 h-1">
        </div>
        <div class="flex items-center gap-3">
            <label>Choose Sample Test Case:</label>
            <select id="file" class="w-24">
                <option value="-">-</option>
            </select>
        </div>
        <div class="flex items-center gap-3">
            <div>
                <label>Row</label>
                <input id="M" class="p-2 border-2 border-gray-500 rounded h-8 w-16" type="number" min="1" max="20" value="4">
            </div>
            <div>
                <label>Column</label>
                <input id="N" class="p-2 border-2 border-gray-500 rounded h-8 w-16" type="number" min="1" max="20" value="4">
            </div>
            <button id="gen" class="bg-green-600 px-3 py-1 rounded text-white hover:bg-green-500 active:bg-green-700">Generate</button>
            <button id="random" class="bg-orange-600 px-3 py-1 rounded text-white hover:bg-orange-500 active:bg-orange-700">Randomize</button>
            <button id="edit" class="bg-blue-600 px-3 py-1 rounded text-white hover:bg-blue-500 active:bg-blue-700">Draw Tile</button>
            <button id="clear" class="bg-red-600 px-3 py-1 rounded text-white hover:bg-red-500 active:bg-red-700">Clear</button>
            <!-- <button id="determine" class="bg-yellow-600 px-3 py-1 rounded text-white hover:bg-yellow-500 active:bg-yellow-700">Determine Tile</button> -->
            <button id="color" class="bg-cyan-600 px-3 py-1 rounded text-white hover:bg-cyan-500 active:bg-cyan-700">Color Tile</button>
        </div>
        <div class="flex items-center gap-3 -mt-3">
            <button id="manual-validate" class="bg-green-600 px-3 py-1 rounded text-white hover:bg-green-500 active:bg-green-700">Validate!</button>
            <button id="solve" class="bg-purple-600 px-3 py-1 rounded text-white hover:bg-purple-500 active:bg-purple-700">Solve!</button>
        </div>
        <div class="min-w-fit w-2/3 h-fit p-5 bg-emerald-200 relative">
            <div class="flex flex-col items-center">
                <div id="tutorial-msg" class="absolute text-lg top-2">

                </div>
                <div id="grid" class="flex flex-col mt-4 p-2 bg-orange-200 h-fit items-end">

                </div>
            </div>
        </div>
        <div class="grid lg:grid-cols-10 md:grid-cols-5 w-1/3 place-items-center gap-2">
            <button id="challenge" class="bg-green-600 w-48 lg:col-span-10 md:col-span-5 px-3 py-1 rounded my-2 text-white hover:bg-green-500 active:bg-green-700">Challenge!</button>
            <button id="CL1" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="1">1</button>
            <button id="CL2" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="2">2</button>
            <button id="CL3" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="3">3</button>
            <button id="CL4" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="4">4</button>
            <button id="CL5" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="5">5</button>
            <button id="CL6" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="6">6</button>
            <button id="CL7" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="7">7</button>
            <button id="CL8" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="8">8</button>
            <button id="CL9" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="9">9</button>
            <button id="CL10" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="10">10</button>
            <button id="CL11" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="11">11</button>
            <button id="CL12" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="12">12</button>
            <button id="CL13" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="13">13</button>
            <button id="CL14" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="14">14</button>
            <button id="CL15" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="15">15</button>
            <button id="CL16" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="16">16</button>
            <button id="CL17" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="17">17</button>
            <button id="CL18" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="18">18</button>
            <button id="CL19" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="19">19</button>
            <button id="CL20" class="challenge-num bg-gray-500 text-white rounded border-2 border-gray-700 w-12 py-1 col-span-1" value="20">20</button>
        </div>
        <div class="flex flex-col items-center">
            <div class="flex items-center gap-2">
                <p class="text-3xl font-semibold">How To Play</p>
            </div>
            <hr class="bg-green-600 w-36 h-1">
        </div>
        <div class="w-2/3 px-5 bg-emerald-200 min-h-3 py-2 h-fit">
            <button id="howtobutton" class="bg-green-600 text-white px-2 rounded"> - </button>
            <div class="howto">
                <ol class="list-decimal p-4 flex flex-col gap-1">
                    <li>Fill the <span class="text-red-500">Row</span> and <span class="text-red-500">Column</span> with a value between <span class="text-red-500">1</span> to <span class="text-red-500">20</span> and press <button class="bg-green-600 px-3 rounded text-white cursor-default">Generate</button> . You can press <button class="bg-orange-600 px-3 rounded text-white cursor-default">Randomize</button> to generate a random puzzle or press <button class="bg-green-600 px-3 rounded text-white cursor-default">Challenge!</button> to play 20 levels of puzzle challenge </li>
                    <li>Red squares <button class="inline text-center w-4 h-4 border-2 border-red-500 bg-white cursor-default"></button> on the grid that is generated are the numerical constraint. 
                        It can be filled with a non-negative number between <span class="text-red-500">0</span> to <span class="text-red-500">the number of row in the grid</span> for the column constraint (resp. <span class="text-red-500">the number of column in the grid</span> for row constraint).
                    </li>
                    <li>
                        To create the tile, press <button class="bg-blue-600 px-3 rounded text-white cursor-default">Edit Grid</button> to enable/disable tile editing. 
                        Press the cell in the grid to make a tile.
                        Hold and drag to make some cells in a same tile and release to stop making a single tile.
                    </li>
                    <li>
                        Press <button class="bg-yellow-600 px-3 rounded text-white cursor-default">Determine Tile</button> to see the tile number.
                    </li>
                    <li>
                        You can try to solve the puzzles by coloring some tiles that previously created.
                        Press <button class="bg-cyan-600 px-3 rounded text-white cursor-default">Color Tile</button> to enable/disable coloring.
                        Then press a cell/tile you wanted to color/uncolor.
                    </li>
                    <li>
                        Press <button class="bg-red-600 px-3 rounded text-white cursor-default">Clear</button> to reset the tile number and coloring status of each tile in the grid.
                        If the number of colored cell in each column and row match the constraint, the orange box will change color to <span class="px-1 rounded text-white bg-green-600">green</span> and a "Solved" text will appear.
                    </li>
                    <li>
                        Press <button class="bg-purple-600 px-3 rounded text-white cursor-default">Solve!</button> to use the solver to automatically find a solution to the puzzle (if any).
                    </li>
                    <li>
                        Press <button class="bg-green-600 px-3 rounded text-white cursor-default">Generate</button> to create new grid or to reset the grid tiles.
                    </li>
                </ol>
            </div>
        </div>
        <div class="flex flex-col items-center">
            <p class="text-3xl font-semibold"></p>
            <hr class="bg-green-600 w-36 h-1">
        </div>
        <div class="flex flex-col items-center">
            <p class="text-3xl font-semibold">Example</p>
            <hr class="bg-green-600 w-24 h-1">
            <p class="py-3"></p>
            <img src={% static "nikoli.png" %} class="w-2/3" alt="nikoli" />
        </div>
        <div class="flex flex-col items-center">
            <p class="text-3xl font-semibold">Rules</p>
            <hr class="bg-green-600 w-16 h-1">
        </div>
        <div class="w-2/3">
            <ol class="list-decimal">
                <li>The areas enclosed by bold lines (blue line in this application) are called “Tiles” and you color the tiles with the following rules.</li>
                <li>A number in a cell with a diagonal line tells the number of black cells there has to be to the right or downward in the line/column of the cell with the diagonal, till the limit of the grid or another cell with a diagonal and numbers.</li>
                <li>The cells of a tile must all be colored or left uncolored.</li>
                <li>The solution will show the outline of a thing or object.</li>
            </ol>
        </div>
    </div>
    <script>
        $(document).ready(() => {
            gen();
        })
    </script>
</body>
</html>